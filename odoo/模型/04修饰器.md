修饰器是可以在不改变函数的基础上增加函数的功能,也可以将[装饰器](https://so.csdn.net/so/search?q=装饰器&spm=1001.2101.3001.7020)本身理解为一种函数,当参数字段的值变化时,便调用此方法



##### @api.constrains(‘xxxx’)

用于评估和检查,当参数字段的值变化时便开始检查,如果检查不通过,则字段值不会发生变化,在前端页面也会抛出一个异常)

```python
@api.constrains('telephone')
  def check_telephone(self):
      if self.search_count([('telephone','=',self.telephone)])>1:
          raise UserError("电话号码必须是唯一的！")
#当电话号重复时,抛出异常,否则记录
```



##### @api.onchange(‘xxxx’)

用于系统在用户进行交互时自动更新相关联的字段,当参数字段的值变化时,抛出提示,但并不会阻止用户的行为

```python
@api.onchange('name')
  def onchange_telephone(self):
      if self.name=="小白":
          return {
              'warning':{
                  'title':"用户异常",
                  'message':"不爱学习的同学不能登记(生气脸)"
              }
          }
#当输入的值为'小白'时,抛出异常
#因为不管爱不爱学习都是学生,所以只警告,并不阻止登记操作,后门还是留的
```



##### @api.depends(‘xxxx’)

用于计算字段,可以用于标记需要被触发的计算.使用此装饰器应该注意计算字段必须被赋值,否则便会报错

```python
computes=fields.Char(string="电话号码数",required=True,compute="depends_telephone")
#在字段中调用才能生效

@api.depends('telephone')
  def depends_telephone(self):
      for record in self:
              record.computes = len(record.telephone)*10
#将电话的长度*10,并返回
#只看代码用法,不必考虑此代码的逻辑,因为此段代码的业务逻辑是瞎编的
```



##### @api.model

会给被装饰的方法自动带上模型该有的信息,开发者不需要传参数,改写odoo的api,就需要用到此修饰器

```python
@api.model
def create(self,vals):
  #继承方法前添加代码:只能使用'vals'
  new_recoed=super().create(vals)
  #继承方法后添加代码:还可以使用'new_recoed'
  return new_recoed
```

在Odoo中，@api.model装饰器是一个装饰器函数，用于将一个方法标记为模型方法。模型方法是指与模型相关的方法，可以访问和操作模型中的数据。使用@api.model装饰器可以确保方法被正确地注册到模型中，并且可以访问和操作模型中的数据。 @api.model装饰器常用于以下场景：

1. 对于不需要访问调用者环境的方法，例如需要访问数据库的方法，可以使用@api.model装饰器标记为模型方法，这样可以确保方法可以正确地访问数据库中的数据。
2. 对于需要与其他模型进行交互的方法，例如需要创建、更新或删除相关记录的方法，可以使用@api.model装饰器标记为模型方法，这样可以确保方法可以正确地访问和操作其他模型中的数据。
3. 对于需要在模型级别上进行操作的方法，例如计算模型中的某些字段或执行某些操作，可以使用@api.model装饰器标记为模型方法，这样可以确保方法可以正确地访问和操作模型中的数据。 例如：

```
class MyModel(models.Model):
    _name = 'my.model'
    field1 = fields.Char()
    field2 = fields.Char()
    
    @api.model
    def my_method(self):
        # 访问MyModel中的数据
        records = self.env['my.model'].search([])
        # ...
```

在这个例子中，@api.model装饰器标记了my_method()方法为模型方法。在方法中，我们使用self.env来访问模型中的数据，并执行一些操作。需要注意的是，@api.model装饰器只能用于模型方法，不能用于视图方法或其他类型的方法。





##### @api.multi

对于多个记录集的操作

```python
@api.multi
def write(self, vals):
    res = super(test_epidemic, self).write(vals)
    return res
```


##### 处理cookie，在middlewares.py中写

```
def get_cookies_dict():
	cookies_str = ''
	cookies_dict = {}
	for item in cookies_str.split('; '):
		key, value = item.split('=', maxsplit=1)
		cookies_dict[key] = value
	return cookies_dict

COOKIES_DICT = get_cookies_dict()
```



##### 下载中间件框架已经帮忙写了：在middlewares.py中写

##### class Scrapy0213DownloaderMiddleware

下载前拦截请求，添加cookie信息或代理

```
def process_request(self, request, spider):
	#加cookie
	request.cookies = COOKIES_DICT
	#加代理
	#request.meta = {'proxy':'...'}
	return None
```



##### 配置中间件：settings.py，取消注释

```
DOWNLOADER_MIDDLEWARES = {
   "scrapy0213.middlewares.Scrapy0213DownloaderMiddleware": 543,
}
```

- 响应前数字小的先执行
- 响应后数字小的后执行
```
[root@pert ~]# ls -li `pwd`
total 48764
917534 -rw-r--r-- 1 root root       14 Dec 13 11:06 1.txt
917532 -r-xr-x--- 1 root root     1679 Sep 22 13:19 8505228_bsrs.top.key
917533 -r-xr-x--- 1 root root     3797 Sep 22 13:19 8505228_bsrs.top.pem
917517 -rw-r--r-- 1 root root   413343 Aug  3 08:27 bt-mysql-install.log
917520 -rw-r--r-- 1 root root    34530 Aug  3 08:27 bt-pure-ftpd.log
917531 -rw-r--r-- 1 root root        0 Sep  1 10:53 e:\user_login_tb.sql
917527 -rw-r--r-- 1 root root 49429323 Sep  1 10:55 myapp_applet_record_value.sql
917515 -rw-r--r-- 1 root root     5232 Jul  1 15:02 mysql.sh
917514 -rw-r--r-- 1 root root    28107 Aug  3 08:23 off_install.sh
917518 -rw-r--r-- 1 root root     3492 Feb 27  2021 phpmyadmin.sh
```

- 第一部分：文件属性
  - 文件数据的inode信息：index node == 索引节点
    - 快速从磁盘中找到数据信息
  - 文件的数据类型：文件、目录、链接文件、设备文件
    - Linux系统中一切皆文件
    - 指明数据的文件类型
      - d：目录
      - -：普通文件
      - l：链接文件
  - 权限位信息：r read读、w write写、x execute执行
    - 控制让不同的用户对文件有不同的权限
    - 有的会有一个`.`，代表是被selinux服务所管理。关闭selinux再创建的文件就没有了
  - 文件目录的硬链接数
    - 可以有多个路径查看数据信息
  - 文件所属用户信息（属主）：
    - 文件的创建者或拥有者
  - 文件的所属组信息（属组）
    - 文件或数据的所属用户组
  - 文件的大小信息
  - 文件的时间信息
- 第二部分：文件名称



##### 文件属性详细说明

- 文件类型：windows：以扩展名来区分文件类型；linux：不用扩展名来区分

  - 颜色区分

  - 利用属性信息区分：ls -l

    - d：目录
    - -：文件
      - 纯文本文件：文本文件，可以直接进行编辑
      - 二进制文件：命令文件，可以直接用但不能编辑（可执行文件）
      - 数据型文件：数据文件，压缩的文件
    - c：块文件，存储的设备文件，光驱设备文件 磁盘
    - b：字符文件，根本停不下来的输出字符信息
    - s：socket文件（网络编程） 
  
    ```
    磁盘设备文件 /dev/sda 磁盘文件
    随机设备文件 	/dev/urandom
    输出设备文件 /dev/zero	黑洞出口文件
    输入设备文件 /dev/null	黑洞入口文件 定时任务
    ```

  - 利用特殊命令

    ```
    file test.txt
    ASCII text
    
    file /etc
    ：directory
    ```



##### 文件权限

- 文件数据权限有什么
  - r read：读权限 4
  - w write：写权限 2
  - x execute：执行权限 1
  - `-`：没有权限
- 权限赋予到指定人
  - 属主信息：文件所有者（监护人）
  - 属组信息：文件所有者（亲人）
  - 其他用户：隔壁老王
- 文件权限是644
  - 属主：rw-
  - 属组：r--
  - 其他用户：r--



##### 用户信息

- 系统中用户信息有什么用

  - 利用用户登陆系统

  - 利用用户管理数据

  - 利用用户管理进程

- 系统如何识别不同的用户

  - 利用用户的数值编号进行识别：uid

    ```
    id root
    uid=0 gid=0 groups=0
    uid：用户名和uid对应关系
    gid：显示属于对用户组，以及组名和gid对应的关系
    groups：用户属于哪些组
    ```

- 用户组的概念
  - 运维：sa（system admin）
  - 开发：dev（development）
  - DBA：dba
- 用户和用户组的关系
  - 一个用户对应用户组 1对1
  - 多个用户对一个用户组 多对1
  - 一个用户对应多个用户组 1对多

- 用户进行分类

  - 超级管理员用户 皇帝 root

    - uid：0
    - 权限：至高无上

  - 虚拟用户            傀儡

    - uid：1-999

    - 权限：管理进程，不能登陆系统和没有家目录

      ```
      id nobody
      ll -d /home/nobody
      ```

  - 普通用户            平民

    - uid：1000+
    - 权限：管理指定的数据、进程，可以登陆系统，有家目录

- 如何保护好皇帝（root）

  - 修改远程连接端口
    - 要想破解需要知道端口和密码
  - 禁止root用户远程登录
    - 修改/etc/ssh/sshd_config
    - 想要破解需要知道端口、哪些普通用户、普通用户密码、root密码

- 满足什么条件可以以root身份登陆系统

  - 服务器地址信息：ip地址
  - 服务器服务的端口信息：改端口
    - 修改/etc/ssh/sshd_config
  - 登陆用户信息：root
  - 登陆用户的密码
    - 暴力破解可以破解你的密码



##### inode：索引节点

- 文件或数据在磁盘中保存位置
- 用于存储文件的属性信息
- 创建文件后系统生成==磁盘格式化 
- 特点说明：
  - inode存放的是文件属性
  - inode存放块的指针位置
  - 创建一个文件至少占用一个inode和一个block
  - 在同一分区中，两个文件的inode号码相同，两个文件互为硬链接



##### block：索引节点指向的位置

- 文件或数据的具体内容
- 创建文件后系统生成==磁盘格式化
- 特点说明：
  - block存放的是数据信息
  - block默认大小为4k，可以进行调整
  - 比较大的文件，会占用多个block
  - 比较小的文件，剩余空间无法使用，浪费磁盘空间（比如10k的文件会占用3个block，占用了12k）
  - 创建一个文件至少占用一个inode和一个block（非空文件）
  - 磁盘读取数据按block为单位读取的
  - 读取一个block会消耗一次磁盘I/O（input/output 磁盘读写）



##### block默认大小可以调整，是大点好还是小点好？

- 大点好：视频、图片公司

  - 文件大的时候：20k 4k---5个block---5s；10k---2个block---2s
  - 节省io消耗

- 小点好：互联网公司

  - 文件小的时候：1k 4k---1个block---1s；10k---1个block---1s

  - 提高磁盘利用率

- 修改命令

  ```
  mkfs.ext3 -b 4096 /dev/sda5 
  ```

- 查看命令

  ```
  查看某分区的block和inode的数量和大小，通常block比inode多
  tune2fs  -l  /dev/sda1 |grep 'Block count'
  tune2fs  -l  /dev/sda1 |grep 'Inode count'
  tune2fs  -l  /dev/sda1 |grep 'Block size'
  tune2fs  -l  /dev/sda1 |grep 'Inode size'
  
  查看各个分区的inode使用个数和剩余个数
  df -i
  
  查看各个分区的block使用个数和使用个数
  df
  
  查看一个block大小
  stat 文件
  ```

  



##### 读取数据的原理

- 找到指定数据
- 读取数据内容，获取inode信息
- 根据inode找到文件位置
- 根据block信息获取真正的文件内容
- 文件的属性信息存储在inode中
- 文件的名称信息存储在上一级目录的block中



##### 如何保证数据真正被删除

- 确保文件的硬链接数为0 i_link
- 确保文件没有被进程占用 i_count



##### 磁盘操作处理过程

- 磁盘：地皮
- raid：将多快地连接起来
- 分区：将地皮进行规划
- 格式化：地皮进行打扫整理
- 创建文件系统：建房风格
  - inode和block
- 挂载：安装门



##### 时间信息：文件数据时间类型

- 访问时间:Access time == atime

- 修改时间:Modify time == mtime（修改文件内容，也等同于修改文件大小）

  ```
  ls -l
  ```

- 改变时间:Changetime == ctime

  - 数据属性（文件大小或权限）

- 使用命令查看三个时间

  ```
  stat 文件
  ```

  

##### 软硬链接<a href='./软链接和硬链接的区别.md'>详情看</a>

- 软链接：快捷方式

  ```
  ln -s /oldboy/old.txt /oldboy/old_link.txt
  			源文件						目标文件
  
  PS：操作任意一个文件两个文件都会改变
  ```

- 硬连接：多个超市门

  ```
  ln /oldboy/old.txt /oldboy/old_link.txt
  			源文件						目标文件
  
  PS：操作任意一个文件两个文件都会改变
  ```

- 软硬链接区别
  - 链接后的文件大小不一致
  - 链接后的文件类型和权限不一致（颜色不一致）
  - 链接后的文件和源文件inode信息有出入
    - 软链接inode号码不一样
    - 硬链接inode号码一致
  - 源文件被删除后
    - 硬链接文件依然有效
    - 软链接文件失效
  - 软链接可以链接目录，进入链接的目录等同于进入被链接目录
  - 硬链接只能链接文件
  
- 利用find命令查找所有的硬链接
  
  ```
  find / -type f -inum inode号码
  ```

- 根据硬链接数得到的信息

  ```
  #查看目录有多少硬链接数
  ls -dl /etc
  
  #查看路径下有多少目录,包含了.和..
  ls -la /etc | grep "^d" | wc -l
  ^：以什么开头
  l：line行数
  
  创建目录默认硬链接为2
  创建文件默认硬链接为1
  ls -ia 目录
  自身是一个硬链接（..）
  .是一个
  
  子目录个数=硬链接数-1（自身）-1（.）
  
  在目录里再创建目录
  ..也是一个硬链接 
  子目录中的..指向上一个目录本身
  子目录中的.指向上一个目录中的文件
  ```
  
  

##### 时间相关命令 ：date

- 查看时间

  ```
  date
  ```

- 调整时间显示格式

  ```
  date "+%F %T"
  
  F:年月日
  T：时分秒
  
  date "+%y-%m-%d %H:%M:%S"
  ```

- 根据日期命令进行命名

  ```
  cp old.log old-`date "+%F_%T"`.log.bak
  ```

- 修改时间

  ```
  date -s "2022/12/15 10:52:01"
  ```

- 获取之后的时间

  ```
  #一天后的时间
  date +%F -d "+1day"
  ```

- 获取之前的时间

  ```
  #两天前的时间
  date +%F -d "-2day"
  ```

- 系统自动备份数据

  ```
  如果设置自动备份的时间是每天的00:00，那看的日志日期文件就是前一天的日志
  cp /old.log /log/old.log.`date +%F`
  需要进行调整，哪天的就是哪天的日志
  cp /old.log /log/old.log.`date +%F -d "-1day"`
  ```

- 同步时间

  ```
  yum install -y ntpdate
  
  ntpdate ntp.aliyun.com
  ```

  



